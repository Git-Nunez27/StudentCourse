# ğŸ”— Router à¹à¸¥à¸° RESTful API Principles

## ğŸ“Œ à¸šà¸—à¸™à¸³

à¹ƒà¸™à¹‚à¸›à¸£à¹€à¸ˆà¸„ Student Course Management System à¹€à¸£à¸²à¹ƒà¸Šà¹‰ **Express Router** à¹€à¸à¸·à¹ˆà¸­à¸ˆà¸±à¸”à¸à¸²à¸£ **Routes** à¹à¸¥à¸°à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸•à¸²à¸¡ **RESTful API Principles** à¹€à¸à¸·à¹ˆà¸­à¹ƒà¸«à¹‰ API à¸¡à¸µà¸¡à¸²à¸•à¸£à¸à¸²à¸™à¹à¸¥à¸°à¸ªà¸²à¸¡à¸²à¸£à¸–à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¹„à¸”à¹‰à¸‡à¹ˆà¸²à¸¢

---

## ğŸ¯ Router à¸„à¸·à¸­à¸­à¸°à¹„à¸£?

### âœ… à¸„à¸³à¸™à¸´à¸¢à¸²à¸¡
**Router** à¸„à¸·à¸­à¸£à¸°à¸šà¸šà¸—à¸µà¹ˆà¸à¸³à¸«à¸™à¸”à¹€à¸ªà¹‰à¸™à¸—à¸²à¸‡ (Route) à¸‚à¸­à¸‡ HTTP requests à¹ƒà¸«à¹‰à¹„à¸›à¸¢à¸±à¸‡à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ (Handler) à¸—à¸µà¹ˆà¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡

### ğŸ“Œ à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™

```
HTTP Request à¸¡à¸²à¸–à¸¶à¸‡
        â†“
  Router à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š
  â”œâ”€ Method? (GET, POST, PUT, DELETE)
  â”œâ”€ Path? (/api/students, /api/courses)
        â†“
  à¹€à¸¥à¸·à¸­à¸ Handler à¸—à¸µà¹ˆà¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡
        â†“
  à¹€à¸£à¸µà¸¢à¸ Controller function
        â†“
  à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
        â†“
  à¸ªà¹ˆà¸‡à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œà¸à¸¥à¸±à¸š
```

---

## ğŸ—ï¸ Router Architecture à¹ƒà¸™à¹‚à¸›à¸£à¹€à¸ˆà¸„

### ğŸ“Š à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£ Router

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           src/server.js (Main Entry Point)            â”‚
â”‚  - à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Express app                                  â”‚
â”‚  - à¸—à¸³ middleware                                        â”‚
â”‚  - à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ routes                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚             â”‚
        â–¼             â–¼             â–¼
    Routes 1     Routes 2      Routes 3
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  studentRoutes.js                      â•‘
    â•‘  â”œâ”€ GET    /api/students               â•‘
    â•‘  â”œâ”€ POST   /api/students               â•‘
    â•‘  â”œâ”€ PUT    /api/students/:id           â•‘
    â•‘  â””â”€ DELETE /api/students/:id           â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  courseRoutes.js                       â•‘
    â•‘  â”œâ”€ GET    /api/courses                â•‘
    â•‘  â”œâ”€ POST   /api/courses                â•‘
    â•‘  â”œâ”€ PUT    /api/courses/:id            â•‘
    â•‘  â””â”€ DELETE /api/courses/:id            â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  enrollmentRoutes.js                   â•‘
    â•‘  â”œâ”€ GET    /api/enrollments            â•‘
    â•‘  â”œâ”€ POST   /api/enrollments            â•‘
    â•‘  â”œâ”€ GET    /api/enrollments/:id        â•‘
    â•‘  â””â”€ DELETE /api/enrollments/:id        â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ“ à¸§à¸´à¸˜à¸µà¸à¸²à¸£à¹ƒà¸Šà¹‰ Router

### ğŸ“Œ à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡ 1: studentRoutes.js

```javascript
/**
 * à¹„à¸Ÿà¸¥à¹Œ Student Routes
 * à¸šà¸—à¸šà¸²à¸—: à¸à¸³à¸«à¸™à¸” endpoints à¸ªà¸³à¸«à¸£à¸±à¸šà¸ˆà¸±à¸”à¸à¸²à¸£à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™
 */

const express = require('express');
const router = express.Router();  // âœ… à¸ªà¸£à¹‰à¸²à¸‡ Router instance
const {
  getAllStudents,
  getStudentById,
  createStudent,
  updateStudent,
  deleteStudent,
  searchStudents
} = require('../controllers/studentController');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“– GET endpoints - à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (Read)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// âœ… GET /api/students
// à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ: à¸”à¸¶à¸‡à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
// à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ: Array à¸‚à¸­à¸‡ students
router.get('/', getAllStudents);

// âœ… GET /api/students/search?query=à¸ªà¸¡à¸Šà¸²à¸¢
// à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ: à¸„à¹‰à¸™à¸«à¸²à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸•à¸²à¸¡à¸Šà¸·à¹ˆà¸­à¸«à¸£à¸·à¸­à¸­à¸µà¹€à¸¡à¸¥
// Query params: ?query=à¸„à¸³à¸„à¹‰à¸™à¸«à¸²
router.get('/search', searchStudents);

// âš ï¸ à¸•à¹‰à¸­à¸‡à¸§à¸²à¸‡ /search à¸à¹ˆà¸­à¸™ /:id à¹€à¸à¸·à¹ˆà¸­à¹ƒà¸«à¹‰ /search à¸—à¸³à¸‡à¸²à¸™à¸à¹ˆà¸­à¸™
// à¸–à¹‰à¸²à¸§à¸²à¸‡ /:id à¸à¹ˆà¸­à¸™ /search à¸ˆà¸°à¸–à¸¹à¸ treat à¹€à¸›à¹‡à¸™ :id = "search"

// âœ… GET /api/students/:id
// à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ: à¸”à¸¶à¸‡à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸•à¸²à¸¡ ID à¹€à¸‰à¸à¸²à¸°à¸„à¸™
// Path params: :id = UUID à¸‚à¸­à¸‡à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™
// à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ: Object à¸‚à¸­à¸‡ student
router.get('/:id', getStudentById);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// â• POST endpoint - à¸ªà¸£à¹‰à¸²à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (Create)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// âœ… POST /api/students
// à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ: à¸ªà¸£à¹‰à¸²à¸‡à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¹ƒà¸«à¸¡à¹ˆ
// Body: { fullname, email, major }
// à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ: Object à¸‚à¸­à¸‡ student à¸—à¸µà¹ˆà¸ªà¸£à¹‰à¸²à¸‡
router.post('/', createStudent);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// âœï¸ PUT endpoint - à¹à¸à¹‰à¹„à¸‚à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (Update)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// âœ… PUT /api/students/:id
// à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ: à¹à¸à¹‰à¹„à¸‚à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™
// Path params: :id = UUID à¸‚à¸­à¸‡à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™
// Body: { fullname?, email?, major? } - à¸­à¸¢à¹ˆà¸²à¸‡à¸™à¹‰à¸­à¸¢ 1 field
// à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ: Object à¸‚à¸­à¸‡ student à¸—à¸µà¹ˆà¹à¸à¹‰à¹„à¸‚
router.put('/:id', updateStudent);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ—‘ï¸ DELETE endpoint - à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (Delete)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// âœ… DELETE /api/students/:id
// à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ: à¸¥à¸šà¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™
// Path params: :id = UUID à¸‚à¸­à¸‡à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™
// Side effects: CASCADE DELETE - à¸¥à¸š enrollments à¸”à¹‰à¸§à¸¢
// à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ: Success message
router.delete('/:id', deleteStudent);

// âœ… à¸ªà¹ˆà¸‡à¸­à¸­à¸ router à¹„à¸›à¹ƒà¸Šà¹‰à¹ƒà¸™à¹„à¸Ÿà¸¥à¹Œ server.js
module.exports = router;
```

---

## ğŸŒ RESTful API Principles

### âœ… à¸„à¸³à¸™à¸´à¸¢à¸²à¸¡
**REST** = **RE**presentational **S**tate **T**ransfer
- à¹€à¸›à¹‡à¸™ architecture style à¸ªà¸³à¸«à¸£à¸±à¸š web services
- à¹ƒà¸Šà¹‰ HTTP methods (GET, POST, PUT, DELETE) à¹à¸—à¸™à¸„à¸³à¸ªà¸±à¹ˆà¸‡
- à¹ƒà¸Šà¹‰ URLs à¹€à¸à¸·à¹ˆà¸­à¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡à¸–à¸¶à¸‡ resources
- Stateless - à¹„à¸¡à¹ˆà¹€à¸à¹‡à¸š state à¸‚à¸­à¸‡ client

### ğŸ¯ à¸«à¸¥à¸±à¸à¸à¸²à¸£ RESTful API 6 à¸‚à¹‰à¸­

#### ğŸ“Œ 1. Client-Server Architecture
```
Request/Response pattern

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client    â”‚ â”€â”€â”€â”€Requestâ”€â”€â†’ â”‚   Server     â”‚
â”‚  (Browser   â”‚                â”‚  (Backend)   â”‚
â”‚ /Postman)   â”‚ â†â”€â”€Responseâ”€â”€â”€ â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡:**
```bash
# Client à¸ªà¹ˆà¸‡ request
curl http://localhost:3000/api/students

# Server à¸•à¸­à¸š response
{
  "success": true,
  "data": [...]
}
```

---

#### ğŸ“Œ 2. Stateless
```
Server à¹„à¸¡à¹ˆà¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ request à¹€à¸à¹ˆà¸²
à¹à¸•à¹ˆà¸¥à¸° request à¸¡à¸µ information à¸„à¸£à¸šà¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œ
```

**à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡:**
```
Request 1: GET /api/students (à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¹€à¸à¹‡à¸š state)
Server: à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”

Request 2: GET /api/students/123 (Request à¹€à¸à¹ˆà¸²à¹„à¸¡à¹ˆà¸¡à¸µà¸œà¸¥)
Server: à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™ ID=123 à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
```

---

#### ğŸ“Œ 3. Cacheable
```
Response à¸„à¸§à¸£ cache à¹„à¸”à¹‰ (à¸–à¹‰à¸²à¹€à¸›à¹‡à¸™ GET)
à¹€à¸à¸·à¹ˆà¸­à¹€à¸à¸´à¹ˆà¸¡à¸›à¸£à¸°à¸ªà¸´à¸—à¸˜à¸´à¸ à¸²à¸
```

**à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡:**
```javascript
// âœ… GET - à¸ªà¸²à¸¡à¸²à¸£à¸– cache à¹„à¸”à¹‰
GET /api/students  â†’ à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œà¹„à¸¡à¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡ â†’ cache à¹„à¸”à¹‰

// âŒ POST, PUT, DELETE - à¹„à¸¡à¹ˆ cache
POST /api/students â†’ à¸ªà¸£à¹‰à¸²à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸«à¸¡à¹ˆ â†’ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™
```

---

#### ğŸ“Œ 4. Uniform Interface
```
API interface à¸¡à¸µà¸£à¸¹à¸›à¹à¸šà¸šà¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™à¸•à¸¥à¸­à¸”
à¸—à¸³à¹ƒà¸«à¹‰à¸‡à¹ˆà¸²à¸¢à¸•à¹ˆà¸­à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™
```

**à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡:**
```
âœ… à¹ƒà¸Šà¹‰ resource à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™
GET    /api/students      (à¸”à¸¶à¸‡)
POST   /api/students      (à¸ªà¸£à¹‰à¸²à¸‡)
PUT    /api/students/:id  (à¹à¸à¹‰à¹„à¸‚)
DELETE /api/students/:id  (à¸¥à¸š)

âŒ à¹„à¸¡à¹ˆà¸„à¸§à¸£à¹ƒà¸Šà¹‰à¹à¸šà¸šà¸™à¸µà¹‰
GET /api/getStudents
POST /api/addStudent
PUT /api/editStudent/:id
DELETE /api/removeStudent/:id
```

---

#### ğŸ“Œ 5. Layered System
```
Client à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸§à¹ˆà¸² Server à¸«à¸¥à¸±à¸‡ layer à¸™à¸µà¹‰à¸¡à¸µà¸£à¸°à¸šà¸šà¸­à¸°à¹„à¸£
à¸—à¸³à¹ƒà¸«à¹‰à¸‡à¹ˆà¸²à¸¢à¸•à¹ˆà¸­à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡à¸£à¸°à¸šà¸š
```

**à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Browser   â”‚ â† Client (à¹„à¸¡à¹ˆà¸£à¸¹à¹‰ backend à¸¡à¸µà¸­à¸°à¹„à¸£)
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
      â”‚ (Request)
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Gateway/Router  â”‚ â† Layer 1
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Controllers         â”‚ â† Layer 2 (Business Logic)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Supabase Database   â”‚ â† Layer 3 (Data)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Client à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸§à¹ˆà¸²à¸¡à¸µ Controller, Database à¸¢à¸±à¸‡à¹„à¸‡
```

---

#### ğŸ“Œ 6. Code on Demand (Optional)
```
Server à¸ªà¸²à¸¡à¸²à¸£à¸–à¸ªà¹ˆà¸‡ code à¹„à¸›à¸¢à¸±à¸‡ client à¹„à¸”à¹‰
(à¹„à¸¡à¹ˆà¸™à¸´à¸¢à¸¡à¹ƒà¸Šà¹‰)
```

---

## ğŸ›£ï¸ HTTP Methods in RESTful API

### ğŸ“Š à¸•à¸²à¸£à¸²à¸‡ HTTP Methods vs Operations

| HTTP Method | CRUD Operation | à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢ | à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡ | Status Code |
|------------||---|---|---|------|
| **GET** | READ | à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ | `GET /api/students` | 200 OK |
| **POST** | CREATE | à¸ªà¸£à¹‰à¸²à¸‡à¹ƒà¸«à¸¡à¹ˆ | `POST /api/students` | 201 Created |
| **PUT** | UPDATE | à¹à¸à¹‰à¹„à¸‚à¹€à¸•à¹‡à¸¡ | `PUT /api/students/1` | 200 OK |
| **PATCH** | UPDATE | à¹à¸à¹‰à¹„à¸‚à¸šà¸²à¸‡à¸ªà¹ˆà¸§à¸™ | `PATCH /api/students/1` | 200 OK |
| **DELETE** | DELETE | à¸¥à¸š | `DELETE /api/students/1` | 204 No Content |

### ğŸ“Œ HTTP Status Codes

```javascript
// âœ… 2xx - Success
200 OK              // Request à¸ªà¸³à¹€à¸£à¹‡à¸ˆ
201 Created         // à¸ªà¸£à¹‰à¸²à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸«à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ
204 No Content      // à¸¥à¸šà¸ªà¸³à¹€à¸£à¹‡à¸ˆ à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸‡à¸à¸¥à¸±à¸š

// âš ï¸ 4xx - Client Error
400 Bad Request     // Request à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡
404 Not Found       // à¹„à¸¡à¹ˆà¸à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥
409 Conflict        // Duplicate data

// ğŸ”´ 5xx - Server Error
500 Internal Server Error  // Server error
```

---

## ğŸ“ URL Structure à¹ƒà¸™ RESTful API

### ğŸ“Œ Pattern à¸—à¸µà¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡

```
http://localhost:3000/api/students
                      â”‚    â”‚
                      â”‚    â””â”€ Resource (à¸—à¸£à¸±à¸à¸¢à¸²à¸à¸£)
                      â””â”€ API prefix
```

### ğŸ“Š à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡ URL Patterns

```
â”Œâ”€ Nouns (à¸—à¸£à¸±à¸à¸¢à¸²à¸à¸£) â”€â”¬â”€ HTTP Method â”€â”¬â”€ à¸„à¸§à¸²à¸¡à¸«à¸¡à¸²à¸¢ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    â”‚               â”‚                                 â”‚
â”‚ /api/students      â”‚ GET           â”‚ âœ… à¸”à¸¶à¸‡à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”         â”‚
â”‚ /api/students      â”‚ POST          â”‚ âœ… à¸ªà¸£à¹‰à¸²à¸‡à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¹ƒà¸«à¸¡à¹ˆ          â”‚
â”‚ /api/students/:id  â”‚ GET           â”‚ âœ… à¸”à¸¶à¸‡à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™ ID à¹€à¸‰à¸à¸²à¸°       â”‚
â”‚ /api/students/:id  â”‚ PUT           â”‚ âœ… à¹à¸à¹‰à¹„à¸‚à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™ ID          â”‚
â”‚ /api/students/:id  â”‚ DELETE        â”‚ âœ… à¸¥à¸šà¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™ ID             â”‚
â”‚ /api/students?q=x  â”‚ GET           â”‚ âœ… à¸„à¹‰à¸™à¸«à¸²à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™ q=query     â”‚
â”‚                    â”‚               â”‚                                 â”‚
â”‚ /api/courses       â”‚ GET           â”‚ âœ… à¸”à¸¶à¸‡à¸§à¸´à¸Šà¸²à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”            â”‚
â”‚ /api/courses       â”‚ POST          â”‚ âœ… à¸ªà¸£à¹‰à¸²à¸‡à¸§à¸´à¸Šà¸²à¹ƒà¸«à¸¡à¹ˆ             â”‚
â”‚ /api/courses/:id   â”‚ PUT           â”‚ âœ… à¹à¸à¹‰à¹„à¸‚à¸§à¸´à¸Šà¸² ID              â”‚
â”‚ /api/courses/:id   â”‚ DELETE        â”‚ âœ… à¸¥à¸šà¸§à¸´à¸Šà¸² ID                 â”‚
â”‚                    â”‚               â”‚                                 â”‚
â”‚ /api/enrollments   â”‚ GET           â”‚ âœ… à¸”à¸¶à¸‡à¸à¸²à¸£à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”   â”‚
â”‚ /api/enrollments   â”‚ POST          â”‚ âœ… à¸ªà¸£à¹‰à¸²à¸‡à¸à¸²à¸£à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¹ƒà¸«à¸¡à¹ˆ    â”‚
â”‚ /api/enrollments/:idâ”‚ DELETE       â”‚ âœ… à¸¥à¸šà¸à¸²à¸£à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™ ID        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âŒ à¹„à¸¡à¹ˆà¸–à¸¹à¸ (à¹ƒà¸Šà¹‰ Verbs à¹à¸—à¸™ Nouns)
GET  /api/getStudents       âœ— à¹ƒà¸Šà¹‰ get (verb)
POST /api/createStudent     âœ— à¹ƒà¸Šà¹‰ create (verb)
PUT  /api/updateStudent/1   âœ— à¹ƒà¸Šà¹‰ update (verb)
```

---

## ğŸ”§ Router Methods

### ğŸ“Œ à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸à¸²à¸£à¹ƒà¸Šà¹‰ Router methods

```javascript
const express = require('express');
const router = express.Router();

// âœ… router.get() - à¸£à¸±à¸š GET requests
router.get('/', (req, res) => {
  res.send('GET request');
});

// âœ… router.post() - à¸£à¸±à¸š POST requests
router.post('/', (req, res) => {
  res.send('POST request');
});

// âœ… router.put() - à¸£à¸±à¸š PUT requests
router.put('/:id', (req, res) => {
  res.send('PUT request');
});

// âœ… router.delete() - à¸£à¸±à¸š DELETE requests
router.delete('/:id', (req, res) => {
  res.send('DELETE request');
});

// âœ… router.all() - à¸£à¸±à¸š requests à¸—à¸¸à¸ method
router.all('/about', (req, res) => {
  res.send('About page');
});

module.exports = router;
```

---

## ğŸ“ Path Parameters vs Query Parameters

### ğŸ“Œ Path Parameters

```
GET /api/students/550e8400-e29b-41d4-a716-446655440000
                  â”‚                                  â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ :id â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

à¹ƒà¸Šà¹‰à¹€à¸¡à¸·à¹ˆà¸­: à¸•à¹‰à¸­à¸‡ identify à¸—à¸£à¸±à¸à¸¢à¸²à¸à¸£ (resource)
à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ: à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™ ID à¸™à¸±à¹‰à¸™à¹à¸šà¸šà¹€à¸‰à¸à¸²à¸°à¹€à¸ˆà¸²à¸°à¸ˆà¸‡
```

**à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¹ƒà¸™ Code:**
```javascript
router.get('/:id', getStudentById);
// URL: /api/students/550e8400-e29b-41d4-a716-446655440000

// à¹ƒà¸™à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ controller
const { id } = req.params;  // âœ… à¸”à¸¶à¸‡ :id à¸ˆà¸²à¸ path
```

---

### ğŸ“Œ Query Parameters

```
GET /api/students/search?query=à¸ªà¸¡à¸Šà¸²à¸¢&limit=10&page=1
                        â”‚       â”‚    â”‚      â”‚
                        â””â”€ ? â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€ query parameters

à¹ƒà¸Šà¹‰à¹€à¸¡à¸·à¹ˆà¸­: à¸•à¹‰à¸­à¸‡à¸à¸£à¸­à¸‡/à¸„à¹‰à¸™à¸«à¸²/sorting à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ: à¸„à¹‰à¸™à¸«à¸²à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸Šà¸·à¹ˆà¸­ "à¸ªà¸¡à¸Šà¸²à¸¢" 10 à¸£à¸²à¸¢à¸à¸²à¸£à¸«à¸™à¹‰à¸² 1
```

**à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¹ƒà¸™ Code:**
```javascript
router.get('/search', searchStudents);
// URL: /api/students/search?query=à¸ªà¸¡à¸Šà¸²à¸¢

// à¹ƒà¸™à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ controller
const { query } = req.query;  // âœ… à¸”à¸¶à¸‡ query string
```

---

## ğŸ¯ Response Format à¸—à¸µà¹ˆà¸ªà¸­à¸”à¸„à¸¥à¹‰à¸­à¸‡à¸à¸±à¸š RESTful

### âœ… Response Structure à¸—à¸µà¹ˆà¸”à¸µ

```javascript
// âœ… Success Response
{
  "success": true,
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "fullname": "à¸ªà¸¡à¸Šà¸²à¸¢ à¹ƒà¸ˆà¸”à¸µ",
    "email": "somchai@example.com",
    "major": "IT",
    "created_at": "2025-11-30T10:00:00Z"
  },
  "message": "âœ… à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸³à¹€à¸£à¹‡à¸ˆ"
}

// âœ… Error Response
{
  "success": false,
  "error": "Invalid student ID",
  "message": "âš ï¸ à¹„à¸¡à¹ˆà¸à¸šà¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™"
}

// âœ… Array Response
{
  "success": true,
  "data": [
    { "id": "...", "fullname": "à¸ªà¸¡à¸Šà¸²à¸¢", ... },
    { "id": "...", "fullname": "à¸ªà¸¡à¸«à¸à¸´à¸‡", ... }
  ],
  "count": 2,
  "message": "âœ… à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”"
}
```

---

## ğŸš€ Server.js - à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ Routes

### ğŸ“ à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡

```javascript
/**
 * à¹„à¸Ÿà¸¥à¹Œ main server
 * à¸šà¸—à¸šà¸²à¸—: à¸ªà¸£à¹‰à¸²à¸‡ Express app, à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² middleware, à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ routes
 */

const express = require('express');
const cors = require('cors');
require('dotenv').config();

const app = express();
const PORT = process.env.PORT || 3000;

// âœ… Middleware
app.use(cors());
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// ğŸ”— Routes - à¸™à¸³à¹€à¸‚à¹‰à¸² route modules
const studentRoutes = require('./routes/studentRoutes');
const courseRoutes = require('./routes/courseRoutes');
const enrollmentRoutes = require('./routes/enrollmentRoutes');

// ğŸ“ API Routes - à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ routes à¹„à¸›à¸¢à¸±à¸‡ paths
app.use('/api/students', studentRoutes);     // âœ… /api/students/*
app.use('/api/courses', courseRoutes);       // âœ… /api/courses/*
app.use('/api/enrollments', enrollmentRoutes); // âœ… /api/enrollments/*

// ğŸ“ Root endpoint
app.get('/', (req, res) => {
  res.status(200).json({
    success: true,
    message: 'Student Course Management System API',
    version: '1.0.0',
    endpoints: {
      students: '/api/students',
      courses: '/api/courses',
      enrollments: '/api/enrollments',
      health: '/health'
    }
  });
});

// ğŸ¥ Health check
app.get('/health', (req, res) => {
  res.status(200).json({
    success: true,
    message: 'Server is running',
    timestamp: new Date()
  });
});

// âš ï¸ 404 Not Found
app.use((req, res) => {
  res.status(404).json({
    success: false,
    message: 'Endpoint not found'
  });
});

// ğŸ”´ Error handling
app.use((err, req, res, next) => {
  console.error('Error:', err);
  res.status(500).json({
    success: false,
    message: 'Internal server error',
    error: err.message
  });
});

// ğŸš€ Start server
app.listen(PORT, () => {
  console.log(`Server is running on port ${PORT}`);
  console.log(`Visit http://localhost:${PORT} for more information`);
});
```

---

## ğŸ“Š Router Flow Diagram

```
â”Œâ”€ HTTP Request à¹€à¸‚à¹‰à¸²à¸¡à¸² â”€â”
â”‚  (GET /api/students) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Express App â”‚
    â”‚ (server.js) â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Route Matching â”‚
    â”‚ /api/students  â”‚ â—€â”€ Match!
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ studentRoutes.js         â”‚
    â”‚ router.get('/', ...)     â”‚ â—€â”€ GET request
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ studentController.js     â”‚
    â”‚ getAllStudents()         â”‚ â—€â”€ Handler function
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ supabase.js              â”‚
    â”‚ SELECT * FROM students   â”‚ â—€â”€ Database query
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€ HTTP Response à¸­à¸­à¸à¹„à¸› â”€â”
    â”‚ { data: [...] }        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ à¸ªà¸£à¸¸à¸›

### âœ… Router Principles

```
1. âœ… Route matching - à¹€à¸¥à¸·à¸­à¸ handler à¸•à¸²à¸¡à¸—à¸£à¸±à¸à¸¢à¸²à¸à¸£
2. âœ… HTTP methods - à¹ƒà¸Šà¹‰ GET, POST, PUT, DELETE à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡
3. âœ… Path parameters - à¸£à¸°à¸šà¸¸ ID à¸‚à¸­à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (:id)
4. âœ… Query parameters - à¸„à¹‰à¸™à¸«à¸²/à¸à¸£à¸­à¸‡ (?query=...)
5. âœ… Response format - à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸šà¸š JSON à¸—à¸µà¹ˆà¹€à¸ªà¸¡à¸­
```

### âœ… RESTful Principles

```
1. âœ… Client-Server separation - Client/Server à¸­à¸´à¸ªà¸£à¸°
2. âœ… Stateless - Server à¹„à¸¡à¹ˆà¹€à¸à¹‡à¸š state à¸‚à¸­à¸‡ client
3. âœ… Cacheable - GET requests à¸ªà¸²à¸¡à¸²à¸£à¸– cache à¹„à¸”à¹‰
4. âœ… Uniform interface - API interface à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™à¸•à¸¥à¸­à¸”
5. âœ… Layered system - à¸‹à¹ˆà¸­à¸™à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸£à¸°à¸šà¸š
6. âœ… Code on demand - Server à¸ªà¹ˆà¸‡ code à¹„à¸”à¹‰ (optional)
```

### âœ… Best Practices

```
âœ… à¹ƒà¸Šà¹‰ Nouns à¹à¸—à¸™ Verbs (/students à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ /getStudents)
âœ… à¹ƒà¸Šà¹‰ HTTP methods à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡ (GET, POST, PUT, DELETE)
âœ… à¹ƒà¸Šà¹‰ Status codes à¸—à¸µà¹ˆà¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡ (200, 201, 404, 500)
âœ… Response format à¸ªà¸­à¸”à¸„à¸¥à¹‰à¸­à¸‡à¸à¸±à¸™
âœ… Error handling à¸—à¸µà¹ˆà¸Šà¸±à¸”à¹€à¸ˆà¸™
âœ… Documentation à¸—à¸µà¹ˆà¸”à¸µ
```

---

**à¸ªà¸£à¹‰à¸²à¸‡à¹€à¸¡à¸·à¹ˆà¸­:** 2025-11-30  
**à¸­à¸±à¸›à¹€à¸”à¸•à¸¥à¹ˆà¸²à¸ªà¸¸à¸”:** 2025-11-30  
**à¸ªà¸–à¸²à¸™à¸°:** âœ… à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œ
